# lrc-ai-assistant

A Lightroom Classic to fill keywords, image title and caption by using ChatGPT or Gemini. There is also advancing support for local Ollama models. Ollama and the models have to be installed manually.

## Available models 28.03.2025
* gpt-4o-mini
* gpt-4o
* Gemini 1.5 flash/pro
* Gemini 2.0 flash
* Gemini 2.0 pro exp
* Ollama
  * deepseek-r1
  * gemma
  * llama3.2-vision
  * llava

## Privacy / Disclaimer
### Your photos will be sent to Google or OpenAI for analysis! Do not use the plugin or use Ollama, if you don't agree with this.

## Usage
* Install plugin using Lightroom addon module manager.
* Obtain an API key for the model you want to use or install Ollama:
  * [Obtain Google Gemini API key](https://aistudio.google.com/app/apikey)
  * [Obtain ChatGPT API key](https://platform.openai.com/api-keys)
  * [Download & Install Ollama](https://ollama.com/download)
* Configure API key in Lightroom module manager. (Not needed for Ollama.)
* Choose the model you want to use on the Lightroom module manager.
* Go to Library in Lightroom
* Select some photos
* Go to menu -> Library -> Addon Modules -> Analyze photo(s) with AI
* If enabled a preflight dialogs pops up, where you cand enter additional information on the photo to the AI, to enhance the results.
* If enabled review before save for title and/or caption and the field is already filled with data, a review dialog will show up.
* Wait it to fill your keywords, caption or title as selected.

## Google rate limits
The free version of gemini-flash is limited to 1500 prompts per day. 
There's also a soft limit on how many requests per minute are allowed, which can of course be circumvented by waiting for a few seconds, when a request is denied.
The plugin waits for 5 seconds after each denied prompt, if the error 'RESOURCE_EXHAUSTED' persists for 10 of these wait loops, it assumes that the daily limit has been hit, and stops the process with an error message. 

You can of course always setup billing at Google to get rid of these limits! Pay-as-you-Go is not too expensive, depending if you flash or pro.
I will implement some kind of cost checking in the future, so you can see how much you will be charged.


## Notes
* Google AI has safety features, so some content is blocked. Especially:
  * Nudity
  * Dangerous scenes
  * Hatecrime
  * ...
 If a photo gets denied by a safety blocked, it will be skipped without further notice (for now).
* All generated keywords are hierarchically beneath the top keyword "Google Gemini". The hierarchy beyond that is fixed.
  But you can easily remove all keywords generated by the plugin, by deleting the top "Google Gemini" keyword.
  Additionally you can create smart collections with filters for "Google Gemini" to keep track of photos that have or haven't been analyzed yet.
* Feel free to open issues or discussions. Any feedback is welcome.

## Support my work
[![Donate](https://img.shields.io/badge/Donate-PayPal-green.svg)](https://www.paypal.com/donate/?hosted_button_id=2LL4K9LN5CFA6)

[![Bitcoin donate](https://bitcoli.com/img/logo-20.png)](https://bitcoli.com/donate/boandlk)

I have to pay fees at Google, because developing the plugin requires testing, which involves paying. If you want to support, please feel free to send me money with PayPal.

## Credits
* @gesteves for [his plugin](https://github.com/gesteves/lightroom-alt-text-plugin), which gave me the idea for this one, and on which the source code is based on.
* @kikito for [inspect.lua](http://github.com/kikito/inspect.lua)
* Jeffrey Friedl for [JSON.lua](http://regex.info/blog/lua/json)
